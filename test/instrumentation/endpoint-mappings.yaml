# Endpoint mappings for Kubernetes metrics documentation generation.
#
# This file maps source file paths to the component and endpoint where metrics are exposed.
# Rules are evaluated in order; first match wins for endpoint mappings.

# Core components: these share common infrastructure (client-go, component-base).
# Metrics from sharedPaths will be attributed to ALL of these components.
coreComponents:
  kube-apiserver:
    - "cmd/kube-apiserver/"
    - "pkg/controlplane/"
    - "pkg/registry/"
    - "pkg/serviceaccount/"
    - "plugin/pkg/admission/"
    - "plugin/pkg/auth/"
    - "staging/src/k8s.io/apiserver/"
    - "staging/src/k8s.io/apiextensions-apiserver/"
    - "staging/src/k8s.io/kube-aggregator/"
    - "staging/src/k8s.io/pod-security-admission/"
  kube-controller-manager:
    - "cmd/kube-controller-manager/"
    - "pkg/controller/"
    - "staging/src/k8s.io/controller-manager/"
    - "staging/src/k8s.io/endpointslice/"
  kube-scheduler:
    - "cmd/kube-scheduler/"
    - "pkg/scheduler/"
    - "staging/src/k8s.io/kube-scheduler/"
  kube-proxy:
    - "cmd/kube-proxy/"
    - "pkg/proxy/"
  kubelet:
    - "cmd/kubelet/"
    - "pkg/kubelet/"
    - "pkg/credentialprovider/"
    - "pkg/volume/"
  cloud-controller-manager:
    - "staging/src/k8s.io/cloud-provider/"

# Standalone components: these have their own specific metrics and do NOT
# share the common infrastructure metrics.
standaloneComponents:
  etcd-version-monitor:
    - "cluster/images/etcd-version-monitor/"

# Shared paths: metrics from these paths are available across ALL core components.
sharedPaths:
  - "staging/src/k8s.io/client-go/"
  - "staging/src/k8s.io/component-base/"

# Endpoint mappings: override the default endpoint for specific paths.
endpointMappings:
  - pathContains: "staging/src/k8s.io/component-base/metrics/slis"
    endpoint: /metrics/slis
  - pathContains: "pkg/kubelet/metrics/collectors/resource_metrics.go"
    endpoint: /metrics/resource
  - pathContains: "pkg/kubelet/prober/"
    endpoint: /metrics/probes

# Default endpoint when no endpointMappings rule matches.
defaultEndpoint: /metrics
